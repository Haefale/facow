<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ AI ì‹ë¬¼ ìƒíƒœ ë° ìƒì¥ ì¡°ê±´ ì°¾ê¸° (ê°€ì„ í…Œë§ˆ)</title>

    <style>
        /* í°íŠ¸ ë° ê¸°ë³¸ ì„¤ì • (ìŠ¤ë§ˆíŠ¸íŒœ ë””ìì¸ ì°¸ê³ ) */
        body {
            font-family: 'Consolas', 'Malgun Gothic', monospace;
            background-color: #F8E6CE; /* ë”°ëœ»í•œ í¬ë¦¼/ë² ì´ì§€ìƒ‰ */
            color: #5A4A3B; /* ì–´ë‘ìš´ ê°ˆìƒ‰ ê³„ì—´ ê¸€ììƒ‰ */
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            cursor: none; /* ë‚™ì—½ ì´í™íŠ¸ë¥¼ ìœ„í•´ ì»¤ì„œ ìˆ¨ê¸°ê¸° */
            text-align: center; /* ë‚´ìš© ì¤‘ì•™ ì •ë ¬ */
        }

        /* í—¤ë” (ìŠ¤ë§ˆíŠ¸íŒœ ë””ìì¸ ì°¸ê³ ) */
        header {
            background-color: #D36C2F; /* ë”°ëœ»í•œ ì˜¤ë Œì§€ ë¸Œë¼ìš´ */
            color: #FFFFFF;
            padding: 20px 15px;
            text-align: center;
            border-bottom: 3px solid #E1854B;
        }
        #page-title {
            font-size: 2.2em;
            margin: 0;
        }
        header p {
            font-size: 1.1em;
            margin: 5px 0;
        }

        /* ì»¨í…Œì´ë„ˆ ë° íŒ¨ë„ ìŠ¤íƒ€ì¼ */
        .container {
            /* AI ê¸°ëŠ¥ì— ë§ê²Œ ì»¨í…Œì´ë„ˆ ì¤‘ì•™ ë°°ì¹˜ ë° ìµœëŒ€ í­ ì„¤ì • */
            max-width: 700px;
            margin: 40px auto;
            background-color: rgba(255, 255, 255, 0.95); /* ë°ì€ ë°°ê²½ */
            padding: 30px;
            border-radius: 10px;
            /* ğŸ¨ ê°€ì„ íŒ¨ë„ ë””ìì¸ ì°¸ê³  */
            border: 1px solid rgba(211, 108, 47, 0.4);
            box-shadow: 0 0 15px rgba(211, 108, 47, 0.4);
            transition: box-shadow 0.3s;
            position: relative;
            z-index: 10;
        }
        .container:hover {
             box-shadow: 0 0 25px rgba(211, 108, 47, 0.6);
        }

        /* ì œëª© (ìŠ¤ë§ˆíŠ¸íŒœ ë””ìì¸ ì°¸ê³ ) */
        h2 {
            color: #D36C2F; /* ëˆˆì— ë„ëŠ” ì£¼í™©/ê°ˆìƒ‰ */
            border-bottom: 1px solid #E1854B;
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 25px;
        }

        /* íŒŒì¼ ì…ë ¥ */
        input[type="file"] {
            margin: 20px 0;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            display: block;
            width: 100%;
            box-sizing: border-box;
            background-color: #fff;
            color: #5A4A3B;
            transition: border-color 0.3s;
        }
        input[type="file"]:hover {
            border-color: #D36C2F;
        }

        /* ë²„íŠ¼ (ìŠ¤ë§ˆíŠ¸íŒœ ë””ìì¸ ì°¸ê³ ) */
        button {
            background-color: #5A4A3B; /* ì§„í•œ ê°ˆìƒ‰ ë²„íŠ¼ */
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            width: 100%;
            margin-top: 10px;
            font-weight: bold;
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        button:hover {
            background-color: #45382D;
            box-shadow: 0 0 10px rgba(90, 74, 59, 0.5);
        }

        /* ê²°ê³¼ ì˜ì—­ (ìŠ¤ë§ˆíŠ¸íŒœ ë””ìì¸ ì°¸ê³ ) */
        #result-area {
            margin-top: 30px;
            padding: 20px;
            border: 2px solid #D36C2F; /* ê°•ì¡° í…Œë‘ë¦¬ */
            border-radius: 5px;
            background-color: #FFF3E0; /* ë°ì€ ë°°ê²½ */
            min-height: 100px;
            text-align: left;
            white-space: pre-wrap;
            font-size: 1.05em;
            line-height: 1.6;
        }
        #result-area strong {
            color: #D36C2F;
            display: block;
            margin-bottom: 10px;
        }
        .loading {
            color: #D36C2F;
            font-weight: bold;
        }
        .error {
            color: #C62828; /* ì§™ì€ ë¹¨ê°•ìœ¼ë¡œ ì˜¤ë¥˜ ê°•ì¡° */
            font-weight: bold;
            background-color: #FFEBEE;
            padding: 10px;
            border-radius: 5px;
        }


        /* ğŸ ë§ˆìš°ìŠ¤ ë‚™ì—½ ì´í™íŠ¸ ìŠ¤íƒ€ì¼ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€) */
        .leaf-particle {
            position: absolute;
            width: 15px; height: 15px;
            background-color: transparent;
            border-radius: 50% 50% 50% 50% / 60% 40% 60% 40%;
            pointer-events: none;
            opacity: 0;
            animation: fallAndFade 2s forwards;
            transform-origin: center center;
            z-index: 9999;
        }
        .leaf-red { background-color: #C62828; }
        .leaf-orange { background-color: #EF6C00; }
        .leaf-yellow { background-color: #FBC02D; }
        .leaf-brown { background-color: #6D4C41; }

        @keyframes fallAndFade {
            0% { transform: translate(0, 0) scale(0.5) rotate(0deg); opacity: 0.8; }
            100% {
                transform: translate(calc(var(--rand-x) * 1px), calc(var(--rand-y) * 1px)) scale(1.2) rotate(calc(var(--rand-deg) * 1deg));
                opacity: 0;
            }
        }

        /* ğŸ ë°°ê²½ ë‚™ì—½ ì´í™íŠ¸ ìŠ¤íƒ€ì¼ (ê¸°ì¡´ ì½”ë“œ ìœ ì§€) */
        .background-leaf {
            position: fixed;
            width: 18px;
            height: 18px;
            background-color: transparent;
            border-radius: 50% 50% 50% 50% / 60% 40% 60% 40%;
            pointer-events: none;
            opacity: 0;
            z-index: 9000;
            animation-name: backgroundFallAndFade;
            animation-duration: var(--leaf-duration);
            animation-timing-function: linear;
            animation-iteration-count: 1;
            animation-fill-mode: forwards;
        }

        .bg-leaf-red { background-color: rgba(198, 40, 40, 0.8); }
        .bg-leaf-orange { background-color: rgba(239, 108, 0, 0.85); }
        .bg-leaf-yellow { background-color: rgba(251, 192, 45, 0.9); }
        .bg-leaf-brown { background-color: rgba(109, 76, 65, 0.8); }

        @keyframes backgroundFallAndFade {
            0% {
                transform: translateX(var(--start-x)) translateY(-300px) scale(var(--leaf-scale)) rotate(0deg);
                opacity: 0.2;
            }
            10% { opacity: var(--leaf-opacity); }
            90% { opacity: var(--leaf-opacity); }
            100% {
                transform: translateX(calc(var(--end-x) + (var(--wind-x) * 1px))) translateY(calc(100vh + 50px)) scale(var(--leaf-scale)) rotate(calc(var(--rand-deg) * 1deg));
                opacity: 0;
            }
        }
    </style>
</head>
<body>


<div class="container">
    <h2>ğŸŒ¿ ì‹ë¬¼ ì´ë¯¸ì§€ ë¶„ì„</h2>
    <p>í’ˆì¢… ì •ë³´, ìƒíƒœ ë° ìƒì¥ ì¡°ê±´ì„ ì–»ê³  ì‹¶ì€ <br>ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</p>

    <input type="file" id="plant-image" accept="image/*">

    <button id="find-button">ìƒíƒœ ë° ì •ë³´ ì°¾ê¸° </button>

    <div id="result-area">
        <strong>ê²€ìƒ‰ ê²°ê³¼:</strong> ì´ê³³ì— ì‹ë¬¼ì˜ ì´ë¦„, ìƒíƒœ, ìƒì¥ ì¡°ê±´ì´ ê°„ê²°í•˜ê²Œ í‘œì‹œë©ë‹ˆë‹¤.
    </div>
</div>

<script>
    // ***************************************************************
    // *** ì¤‘ìš”: ì‹¤ì œ Gemini API í‚¤ë¥¼ "YOUR_GEMINI_API_KEY" ëŒ€ì‹  ì…ë ¥í•˜ì„¸ìš”! ***
    // ***************************************************************
    const GEMINI_API_KEY = "AIzaSyBxN74a9N6VkLi_CdwLRPfZ7nyJRqVJTQE";

    document.getElementById('find-button').addEventListener('click', findPlantSpecies);

    // ì´ë¯¸ì§€ë¥¼ base64 ë¬¸ìì—´ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
    function fileToGenerativePart(file) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = (event) => {
                const base64Data = event.target.result.split(',')[1];
                resolve({
                    inlineData: {
                        data: base64Data,
                        mimeType: file.type,
                    },
                });
            };
            reader.onerror = (error) => reject(error);
            reader.readAsDataURL(file);
        });
    }

    // í’ˆì¢…ì„ ì°¾ëŠ” ë©”ì¸ í•¨ìˆ˜ (API í˜¸ì¶œ)
    async function findPlantSpecies() {
        const fileInput = document.getElementById('plant-image');
        const resultArea = document.getElementById('result-area');

        if (fileInput.files.length === 0) {
            resultArea.innerHTML = `<div class="error">âš ï¸ ì˜¤ë¥˜: ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!</div>`;
            return;
        }
        if (GEMINI_API_KEY === "YOUR_GEMINI_API_KEY" || !GEMINI_API_KEY) {
            resultArea.innerHTML = `<div class="error">âš ï¸ ì˜¤ë¥˜: ìœ íš¨í•œ API í‚¤ë¥¼ 'GEMINI_API_KEY' ë³€ìˆ˜ì— ì…ë ¥í•´ì£¼ì„¸ìš”!</div>`;
            return;
        }

        const imageFile = fileInput.files[0];

        // UI ìƒíƒœ ë³€ê²½
        resultArea.innerHTML = `<strong class="loading">ğŸ” ì´ë¯¸ì§€ ë¶„ì„ ì¤‘... (ë„¤íŠ¸ì›Œí¬ ìƒí™©ì— ë”°ë¼ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)</strong>`;

        try {
            const imagePart = await fileToGenerativePart(imageFile);

            // ìš”ì²­ ë©”ì‹œì§€ (ìƒíƒœ, ì´ë¦„, ìƒì¥ ì¡°ê±´ë§Œ ê°„ê²°í•˜ê²Œ ìš”ì²­)
            const prompt = "ì´ ì´ë¯¸ì§€ ì† ì‹ë¬¼ì˜ ì´ë¦„ì„ ì•Œë ¤ì£¼ì„¸ìš”. ê·¸ë¦¬ê³  ì´ ì‹ë¬¼ì˜ í˜„ì¬ ìƒíƒœ(ê±´ê°•, ë³‘ì¶©í•´ ì—¬ë¶€ ë“±)ë¥¼ ê°„ê²°í•˜ê²Œ í‰ê°€í•´ì£¼ì„¸ìš”. ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ ì‹ë¬¼ì„ ì˜ í‚¤ìš°ê¸° ìœ„í•œ ìƒì¥ ì¡°ê±´(ë¬¼ ì£¼ê¸°, í–‡ë¹›, ì˜¨ë„)ì„ ìš”ì•½í•´ì„œ ì•Œë ¤ì£¼ì‹­ì‹œì˜¤. ë‹µë³€ì€ ê° ì •ë³´ë¥¼ '---'ë¡œ êµ¬ë¶„í•˜ì—¬ ì„¸ ê°€ì§€ í•­ëª©ìœ¼ë¡œë§Œ ì¶œë ¥í•´ì£¼ì„¸ìš”.";

            // ìš”ì²­ ë³¸ë¬¸ êµ¬ì„±
            const requestBody = {
                contents: [{
                    parts: [
                        imagePart,
                        { text: prompt }
                    ]
                }],
                generationConfig: {
                    maxOutputTokens: 2048
                }
            };

            // Gemini API í˜¸ì¶œ
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestBody),
            });

            // HTTP ìƒíƒœ ì½”ë“œì— ë”°ë¥¸ ì˜¤ë¥˜ ì²˜ë¦¬
            if (!response.ok) {
                const errorData = await response.json();
                let errorMessage = `API í˜¸ì¶œ ì‹¤íŒ¨: HTTP ${response.status} (${response.statusText})`;

                if (errorData && errorData.error && errorData.error.message) {
                    errorMessage += `<br>ìƒì„¸ ë‚´ìš©: ${errorData.error.message}`;
                }
                throw new Error(errorMessage);
            }

            const data = await response.json();

            // ê²°ê³¼ í‘œì‹œ
            const resultText = data.candidates?.[0]?.content?.parts?.[0]?.text || "ì£„ì†¡í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ëŠ” ë° ì‹¤íŒ¨í–ˆê±°ë‚˜ ì‘ë‹µì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤.";
            resultArea.innerHTML = `<strong>âœ… ë¶„ì„ ì™„ë£Œ!</strong><br><br>${resultText}`;

        } catch (error) {
            // ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í™”ë©´ì— í‘œì‹œ
            const displayMessage = error.message.includes("API í˜¸ì¶œ ì‹¤íŒ¨")
                ? error.message
                : `ë„¤íŠ¸ì›Œí¬ ë˜ëŠ” CORS ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (ë¸Œë¼ìš°ì € ì •ì±… ë¬¸ì œ) ì½˜ì†”(F12)ì„ í™•ì¸í•´ì£¼ì„¸ìš”!`;

            resultArea.innerHTML = `<div class="error">âš ï¸ ì˜¤ë¥˜ ë°œìƒ: ${displayMessage}</div>`;

            // ì½˜ì†”ì—ë„ ì˜¤ë¥˜ëŠ” ê³„ì† ì¶œë ¥
            console.error("ìµœì¢… ì˜¤ë¥˜:", error);
        }
    }


    // ğŸ ë§ˆìš°ìŠ¤ ë‚™ì—½ ì´í™íŠ¸ JavaScript
    const mouseLeafColors = ['leaf-red', 'leaf-orange', 'leaf-yellow', 'leaf-brown'];

    document.addEventListener('mousemove', function(e) {
        const particle = document.createElement('div');
        particle.className = 'leaf-particle';
        document.body.appendChild(particle);

        const randomColorClass = mouseLeafColors[Math.floor(Math.random() * mouseLeafColors.length)];
        particle.classList.add(randomColorClass);

        const size = Math.random() * 8 + 12;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';

        particle.style.left = (e.clientX - size / 2) + 'px';
        particle.style.top = (e.clientY - size / 2) + 'px';

        // íšŒì „ê³¼ ì¢Œìš° ì›€ì§ì„ ê°•í™”
        particle.style.setProperty('--rand-x', Math.random() * 300 - 150);
        particle.style.setProperty('--rand-y', Math.random() * 250 + 70);
        particle.style.setProperty('--rand-deg', Math.random() * 1080 - 540);

        particle.addEventListener('animationend', function() {
            particle.remove();
        });
    });

    // ğŸ ë°°ê²½ ë‚™ì—½ ì´í™íŠ¸ JavaScript
    const bgLeafColors = ['bg-leaf-red', 'bg-leaf-orange', 'bg-leaf-yellow', 'bg-leaf-brown'];

    function createBackgroundLeaf() {
        const leaf = document.createElement('div');
        leaf.className = 'background-leaf';
        document.body.appendChild(leaf);

        const randomColorClass = bgLeafColors[Math.floor(Math.random() * bgLeafColors.length)];
        leaf.classList.add(randomColorClass);

        const size = Math.random() * 10 + 15;
        leaf.style.width = size + 'px';
        leaf.style.height = size + 'px';

        const startX = Math.random() * window.innerWidth;
        leaf.style.left = startX + 'px';

        const duration = Math.random() * 5 + 10;

        leaf.style.setProperty('--start-x', startX + 'px');
        // ë°”ëŒì— ë‚ ë¦¬ëŠ” íš¨ê³¼ë¥¼ ìœ„í•´ ì¢Œìš° ì›€ì§ì„ í­ì„ ë” ë„“ê²Œ
        leaf.style.setProperty('--end-x', (startX + (Math.random() * 400 - 200)) + 'px');
        leaf.style.setProperty('--rand-deg', Math.random() * 1080 - 540);
        leaf.style.setProperty('--leaf-duration', duration + 's');
        leaf.style.setProperty('--leaf-scale', Math.random() * 0.7 + 0.8);
        leaf.style.setProperty('--leaf-opacity', Math.random() * 0.2 + 0.7);

        // ë‚™ì—½ì´ ì¢Œìš°ë¡œ í”ë“¤ë¦¬ë©° ë–¨ì–´ì§€ëŠ” ëŠë‚Œ ì¶”ê°€ (backgroundFallAndFade ì• ë‹ˆë©”ì´ì…˜ì—ì„œ --wind-x ë³€ìˆ˜ í™œìš©)
        leaf.style.setProperty('--wind-x', Math.random() * 100 - 50);

        leaf.addEventListener('animationend', function() {
            leaf.remove();
        });
    }

    setInterval(createBackgroundLeaf, 300);
</script>
</body>
</html>